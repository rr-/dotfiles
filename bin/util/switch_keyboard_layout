#!/bin/python3
# Switches between Polish and Japanese keyboard layout for ibus
# (the default switcher of ibus was too buggy)

import os
from subprocess import run, PIPE


def main():
    if run(['pgrep', 'ibus-daemon'], stdout=PIPE).returncode != 0:
        print('starting daemon')
        subprocess.run(os.path.expanduser('~/.config/ibus/start'))

    engine = run(['ibus', 'engine'], stdout=PIPE).stdout.decode().strip()
    if engine != 'anthy':
        run(['ibus', 'engine', 'anthy'])
    else:
        run(['ibus', 'engine', 'xkb:pl::pol'])


if __name__ == '__main__':
    main()
